<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bebas+Neue:wght@400&display=swap">

  <title>The Nurturing Nature Network</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    header {
      font-family: 'Bebas Neue', sans-serif; /* Apply Bebas Neue to the header */
      background-color:  #3a6238; /* Light pastel green */
      color: black; /* Changed color to black */
      padding: 8px; /* Decreased padding */
      text-align: left; /* Align the title to the left */
      display: flex;
      justify-content: space-between; /* Align the navbar to the right */
      align-items: center; /* Vertically center content in the header */
      letter-spacing: 2px; /* Adjust the value as needed */
    }

    h1 {
      font-size: 1.5rem; /* Decreased font size */
      margin: 0; /* Remove margin to prevent spacing */
    }
    
    .logo-container {
      display: flex;
      align-items: center;
    }

    .logo {
      width: 35px; /* Adjust the width of the logo */
      height: 35px; /* Adjust the height of the logo */
      margin-right: 10px; /* Adjust the margin between the logo and text */
    }


    #navbar {
      overflow: hidden;
    }

    #navbar a {
      float: left;
      display: block;
      color: black; /* Changed color to black */
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-family: 'Bebas Neue', sans-serif; /* Apply Bebas Neue to the navbar links */
      letter-spacing: 2px; /* Adjust the value as needed */
    }

    #navbar a:hover {
      background-color: #4f804f; /* Darker shade on hover */
      color: white;
    }

    #map {
      position: absolute;
      top: 50px; /* Adjust as needed based on header height */
      left: 0;
      width: 100vw;
      height: calc(100vh - 50px); /* Adjust as needed based on header height */
      background-image: url('images/map of kampung Kampus2.jpg');
      background-size: 100% 100%;
      background-position: center;
    }

    .tree {
      position: absolute;
      width: 100px; /* Adjust based on your tree image size */
      height: 100px; /* Adjust based on your tree image size */
      cursor: pointer;
    }

    .zone-name {
      font-size: 13px; /* Adjust the font size as needed */
      font-weight: bold; /* Make the zone names bold */
      font-family: 'Serif', sans-serif; /* Change font to Serif */
      color: #fff; /* Set text color to white */
      background-color: #000; /* Set background color to black */
      padding: 5px; /* Add padding for the black box */
      border-radius: 0px; /* Add border-radius for rounded corners */
      white-space: nowrap;
      text-align: center;
      position: absolute;
      left: 70%;
      display: inline-block; /* Adjust display property to inline-block */
    }



    .legend {
      position: absolute;
      top: 80px; /* Adjust based on your design */
      left: 20px; /* Adjust based on your design */
      cursor: pointer;
      z-index: 2;
      font-weight: bold; /* Make the word 'Legend' bold */
      font-family: 'Serif', sans-serif; /* Change font to Serif */
    }

    .legend img {
      width: 30px; /* Increased size of the legend icon */
      height: 30px; /* Increased size of the legend icon */
      border: 2px solid black; /* Thicken the border */
      display: block;
      margin: 0 auto; /* Center the legend icon */
    }

    .legend-popup {
      display: none;
      position: absolute;
      background-color: #836953; /* Pastel brown color */
      padding: 10px;
      z-index: 2;
    }

    .legend:hover .legend-popup {
      display: block;
    }

    .legend-popup img {
      width: 50px; /* Adjust based on your design */
      height: 50px; /* Adjust based on your design */
      margin-right: 5px;
    }

    .progress-bar-container {
      position: fixed;
      bottom: 10px;
      left: 10px;
      display: none;
    }

    .progress-bar {
      width: 100px;
      height: 10px;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background-color: #4CAF50;
      border-radius: 5px;
    }

    #coin-display {
      position: fixed;
      top: 60px; /* Adjust the top position based on your header height */
      right: 20px;
      background-color: rgba(128, 128, 128, 0.7); /* Grey translucent background */
      padding: 10px;
      border-radius: 5px;
      border: 2px solid black; /* Thicken the border */
      display: flex;
      z-index: 2;
      align-items: center;
      width: 100px; /* Adjust the width as needed */
    }

    #coin-display img {
      margin-right: 5px;
    }

    #coin-count {
      font-size: 25px;
      font-weight: bold;
      color: black; /* Set the font color to gold */
    }

  </style>
</head>
<body>
  <header>
    <div class="logo-container">
      <img src="images/GUI logo.png" alt="Logo" class="logo">
      <h1>The Nurturing Nature Network</h1>
    </div>
    <div id="navbar">
      <a href="/achievements">
        Achievements
      </a>
      <a href="/friends">
        Friends
      </a>
      <a href="/store">
        Store
      </a>
      <a href="/my-account">
        My Account
      </a>

    </div>
  </header>

  <div id="coin-display">
    <img src="images/coin.png" alt="Coin Icon" width="30" height="30">
    <span id="coin-count">100</span>
  </div>

  <div class="legend">
    <img src="images/legendicon.png" alt="Tree Icon" width="40" height="40">
    Legend
    <div class="legend-popup">
      <!-- Include images for each achievement level in the legend -->
      <p>Level 1: <img src="images/treelvl1.png" alt="Achievement Level 1"></p>
      <p>Level 2: <img src="images/treelvl2.png" alt="Achievement Level 2"></p>
      <p>Level 3: <img src="images/treelvl3.png" alt="Achievement Level 3"></p>
      <p>Level 4: <img src="images/treelvl4.png" alt="Achievement Level 4"></p>
      <p>Level 5: <img src="images/treelvl5.png" alt="Achievement Level 5"></p>
      <p>Level 6: <img src="images/treelvl6.png" alt="Achievement Level 6"></p>
    </div>
  </div>

  <div id="map">
    <!-- Trees will be dynamically added here based on achievement levels -->
    <!-- Example tree: -->
    <!-- <img id="tree1" class="tree" src="images/tree_icon.png" style="top: 100px; left: 200px;"> -->
  </div>

  <div class="progress-bar-container" id="progress-bar-container">
    <div class="progress-bar" id="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Fetch user achievement data
      const username = 'replace-with-actual-username'; // Replace with the actual username
      fetch(`/user/${username}/achievements`)
        .then(response => response.json())
        .then(data => {
          updateTrees(data);
          addHoverEventListener();
        })
        .catch(error => console.error('Error fetching achievement data:', error));
      });

    // Simulated achievement data (replace this with actual data from your backend)
    const achievementData = {
      zone1: { level: 1, coordinates: { top: 330, left: 1160 } },
      zone2: { level: 2, coordinates: { top: 450, left: 820 } },
      zone3: { level: 3, coordinates: { top: 460, left: 460 } },
      zone4: { level: 4, coordinates: { top: 330, left: 710 } },
      zone5: { level: 5, coordinates: { top: 260, left: 900 } },
      zone6: { level: 6, coordinates: { top: 240, left: 1055 } },
      zone7: { level: 6, coordinates: { top: 170, left: 1130 } },
      zone8: { level: 6, coordinates: { top: 150, left: 960 } },
      zone9: { level: 6, coordinates: { top: 170, left: 700 } },
      zone10: { level: 6, coordinates: { top: 330, left: 205 } },
    };

    const zoneNames = {
      zone1: 'HeartQuarters',
      zone2: 'Prototyping Zone',
      zone3: 'A-Maze',
      zone4: 'The Multiplex',
      zone5: 'Living Heritage Centre',
      zone6: 'Farming Plot',
      zone7: 'Padi Field',
      zone8: 'Camp Grounds',
      zone9: 'Bambusa',
      zone10: 'Amphitheatre',
    };


    // Update trees based on achievement levels
    updateTrees(achievementData);

    // Function to update trees based on achievement levels
    function updateTrees(achievementData) {
      for (const zoneId in achievementData) {
        const treeId = 'tree' + zoneId.substring(4); // Assuming zoneId is in the format 'zoneX'
        const { level, coordinates } = achievementData[zoneId];
        placeTree(treeId, level, coordinates, zoneId);
      }
    }

    // Function to place a tree for a specific zone
// Function to place a tree for a specific zone
    function placeTree(treeId, achievementLevel, coordinates, zoneId) {
      const map = document.getElementById('map');

      // Create a new tree element
      const tree = document.createElement('img');
      tree.id = treeId;
      tree.className = 'tree';
      tree.src = `images/treelvl${achievementLevel}.png`; // Adjust based on your tree image naming
      tree.style.top = `${coordinates.top}px`;
      tree.style.left = `${coordinates.left}px`;
      tree.setAttribute('data-zone', zoneId); // Add data-zone attribute

      // Append the tree to the map
      map.appendChild(tree);

      // Create a new element for the zone name
      const zoneName = document.createElement('div');
      zoneName.className = 'zone-name';
      zoneName.textContent = zoneNames[zoneId] || zoneId; // Display the zone name
      zoneName.style.position = 'absolute';
      zoneName.style.top = `${coordinates.top + 110}px`; // Adjust the vertical position as needed
      zoneName.style.left = `${coordinates.left}px`;
      zoneName.style.textAlign = 'center';
      zoneName.setAttribute('data-zone', zoneId); // Add data-zone attribute

      // Append the zone name under the tree
      map.appendChild(zoneName);
    }


    // Hover event listener for trees
    document.getElementById('map').addEventListener('mouseover', function (event) {
      const tree = event.target;
      const zoneId = tree.getAttribute('data-zone');

      // Check if the element is a tree with a data-zone attribute
      if ((tree.classList.contains('tree') || tree.classList.contains('zone-name')) && tree.getAttribute('data-zone')) {
        const zoneId = tree.getAttribute('data-zone');
        fetch(`/user/${username}/progress/${zoneId}`)
          .then(response => response.json())
          .then(progress => updateProgressBar(progress))
          .catch(error => console.error('Error fetching progress data:', error));
      }
    });
    document.getElementById('map').addEventListener('mouseout', function (event) {
      const target = event.target;

      // Check if the element is a tree or zone name with a data-zone attribute
      if (!(target.classList.contains('tree') || target.classList.contains('zone-name'))) {
          // Hide the progress bar
          document.getElementById('progress-bar-container').style.display = 'none';
      }
    });

    // Function to get progress for a specific zone (replace with MongoDB logic)
    function getProgressForZone(zoneId) {
      // Simulated data, replace with MongoDB logic
      const achievementPercentage = {
        zone1: 30,
        zone2: 45,
        zone3: 50,
        zone4: 55,
        zone5: 60,
        zone6: 65,
        zone7: 75,
        zone8: 70,
        zone9: 10,
        zone10: 5,
      };
      return achievementPercentage[zoneId] || 0;
    }
    // Function to update the progress bar based on progress percentage
    function updateProgressBar(progress) {
      const progressBar = document.getElementById('progress-bar');
      const progressFill = document.getElementById('progress-fill');

      // Update the width of the progress fill based on the progress percentage
      progressFill.style.width = `${progress}%`;

      // Show the progress bar container
      document.getElementById('progress-bar-container').style.display = 'block';
    }

    /**fetch('YOUR_BACKEND_API_URL/coins')
      .then(response => response.json())
      .then(data => {
        const coinCount = data.coinCount || 0;
        updateCoinCount(coinCount);
      })
      .catch(error => console.error('Error fetching coin count:', error));**/
    const arbitraryCoinCount = 100;

    // Function to update the displayed coin count
    function updateCoinCount(coinCount) {
      document.getElementById('coin-count').textContent = coinCount;
    }
  </script>

</body>
</html>